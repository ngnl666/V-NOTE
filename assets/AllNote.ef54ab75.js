var e=Object.defineProperty,t=Object.defineProperties,a=Object.getOwnPropertyDescriptors,s=Object.getOwnPropertySymbols,r=Object.prototype.hasOwnProperty,l=Object.prototype.propertyIsEnumerable,o=(t,a,s)=>a in t?e(t,a,{enumerable:!0,configurable:!0,writable:!0,value:s}):t[a]=s,i=(e,t)=>{for(var a in t||(t={}))r.call(t,a)&&o(e,a,t[a]);if(s)for(var a of s(t))l.call(t,a)&&o(e,a,t[a]);return e};import{B as n,E as d,C as c,t as p,v as u,x as m,y,R as g,X as x,P as f,Q as v,L as h,D as w,A as b,n as k,F as N,J as j,V as S,I as T}from"./vendor.5dda48dc.js";import{L as M}from"./vue-loading.67b0a97d.js";import{S as C}from"./sweetalert2.b9aa7158.js";import{f as L}from"./format.31a05643.js";import{_ as O,a as _}from"./NoteTopBar.5c7aac5e.js";const B={name:"MyNotes",props:{myNote:{type:Object}},components:{Modal:O,NoteTopBar:_},setup(e){const t=n("store"),{state:a,addStar:s,setShowModal:r,setAlertMsg:l,getTime:o,setKeyword:p,editNote:u,publishNote:m}=t,{markup:y}=L;let g=d(!0);const x=c(e).myNote,f=d(`${x.value.content.substring(0,200)}．．．`),v=new Promise((e=>{setTimeout((()=>{e({"0.jpg":"<img class='scenery' src='../src/assets/images/0.jpg'/>","1.jpg":"<img class='scenery' src='../src/assets/images/1.jpg'/>","2.jpg":"<img class='scenery' src='../src/assets/images/2.jpg'/>"})}),1e3)}));return setTimeout((()=>g.value=!1),1e3),{addStar:s,getTime:o,loadNote:g,myNote:x,setShowModal:r,tempContent:f,highLight:e=>{if(a.keyword){let t=e.replace(new RegExp(a.keyword,"g"),`<span class="text-red-400">${a.keyword}</span>`);return y(t)}return y(e)},markup:y,openShareBox:async e=>{const{value:t}=await C.fire({title:`確定發布 <span class="text-red-400">${e}</span> 至探索`,html:"<p>平台上的所有人將會看到你發佈的文章，請先選擇背景圖</p>",width:"800px",input:"radio",confirmButtonText:"發佈",inputOptions:v,inputValidator:e=>{if(!e)return"請選擇一張背景圖!"}});if(x.value.shared&&l("error","你已經分享過此文章了！"),t&&!x.value.shared){const e={_id:x.value._id,scene:t,like:0},a=i({},x.value);a.shared=!0,await u(a._id,a),m(e),C.fire({html:"<p>發布成功！</p>",icon:"success"})}},searchTag:e=>p(`#${e}`)}}},K={class:"p-2 md:p-4"},P={key:0},H={class:"flex justify-between px-2 mb-6 md:px-6"},I=y("i",{class:"fas fa-share-alt"},null,-1),A=y("i",{class:"far fa-trash-alt"},null,-1),$={class:"text-yellow-400 md:text-xl"},R={class:"px-2 mb-8 md:px-6"},E=y("span",{class:"text-indigo-500 inline-flex items-center mt-4 md:text-xl"},[b("閱讀更多 "),y("i",{class:"fas fa-arrow-right ml-2"})],-1),V={class:"my-4 md:flex justify-between"},D={class:"flex flex-wrap"},U={class:"md:text-xl dark:text-white"},F=y("hr",null,null,-1),J={key:1,class:"shadow rounded-md p-4"},Q=x('<div class="flex animate-pulse space-x-4"><div class="h-12 w-12 bg-gray-400 rounded-full"></div><div class="flex-1 space-y-4 py-1"><div class="h-4 w-3/4 bg-gray-400 rounded"></div><div class="space-y-2"><div class="h-4 bg-gray-400 rounded"></div><div class="h-4 w-5/6 bg-gray-400 rounded"></div></div></div></div>',1);B.render=function(e,t,a,s,r,l){const o=p("NoteTopBar"),i=p("router-link");return u(),m("div",K,[s.loadNote?(u(),m("div",J,[Q])):(u(),m("div",P,[y("div",H,[y("h3",{class:"text-gray-900 text-2xl font-medium md:text-3xl dark:text-white",innerHTML:s.highLight(s.myNote.title)},null,8,["innerHTML"]),y(o,null,{edit:g((()=>[y("span",{class:"noteTopBarIcon mr-1 md:text-xl",onClick:t[1]||(t[1]=e=>s.openShareBox(s.myNote.title))},[I])])),delete:g((()=>[y("span",{class:"noteTopBarIcon md:text-xl",onClick:t[2]||(t[2]=e=>s.setShowModal(s.myNote,!0))},[A])])),star:g((()=>[y("span",$,[s.myNote.stared?(u(),m("i",{key:1,class:"fas fa-star iconHover",onClick:t[4]||(t[4]=e=>s.addStar(s.myNote._id,!1))})):(u(),m("i",{key:0,class:"far fa-star iconHover",onClick:t[3]||(t[3]=e=>s.addStar(s.myNote._id,!0))}))])])),_:1})]),y(i,{to:`/current/view/${s.myNote._id}`,class:"cursor-pointer"},{default:g((()=>[y("div",R,[y("section",{class:"break-words text-gray-500 md:text-xl dark:text-gray-400",innerHTML:s.highLight(s.tempContent)},null,8,["innerHTML"]),E]),y("div",V,[y("ul",D,[(u(!0),m(f,null,v(s.myNote.tags,((e,t)=>(u(),m("li",{class:"bg-gray-200 text-white rounded-md px-2 py-0.5 mr-4 mb-4 hover:bg-black md:mb-0 md:text-xl dark:bg-gray-400 dark:hover:bg-black",key:t,onClick:h((t=>s.searchTag(e)),["prevent"])}," # "+w(e),9,["onClick"])))),128))]),y("div",U,w(s.getTime(s.myNote.createdAt)),1)]),F])),_:1},8,["to"])]))])};const X={name:"AllNote",components:{Loading:M,MyNotes:B},setup(){const e=n("store"),{state:s,getAllNote:r,setKeyword:l,sortMyNotes:o}=e,p=d(!0),u=k({get:()=>s.keyword,set:e=>l(e.replace(/[^\w\s]/gi,""))});return N((async()=>{await r()})),m=i({},c(s)),t(m,a({clearInput:()=>l(""),currKeyword:u,isRotate:p,setKeyword:l,timeSort:()=>{p.value=!p.value,o(p.value)}}));var m}},q={class:"max-w-4xl mx-auto px-2 md:px-6"},z={class:"border border-gray-300 rounded-3xl p-8"},G={class:"mb-4 justify-between md:flex md:mb-8"},W=y("h2",{class:"pageTitle"},"文章列表",-1),Y={class:"flex justify-center"},Z={class:"relative mb-4 md:mb-0"},ee=y("i",{class:"far fa-times-circle duration-150 hover:rotate-90"},null,-1),te=y("i",{class:"fas fa-star"},null,-1),ae=b(" 照時間順序"),se={class:"ml-2"},re=y("hr",null,null,-1),le={key:0,class:"text-center"},oe=y("p",{class:"reminder"},"目前還沒有發表任何文章喔!",-1),ie=b("回首頁");X.render=function(e,t,a,s,r,l){const o=p("loading"),i=p("MyNotes"),n=p("router-link");return u(),m("div",q,[y(o,{active:e.loadingStatus.isLoading,"onUpdate:active":t[1]||(t[1]=t=>e.loadingStatus.isLoading=t),"can-cancel":!0,"is-full-page":e.loadingStatus.fullPage,blur:e.loadingStatus.blur,loader:e.loadingStatus.loader,color:e.loadingStatus.color},null,8,["active","is-full-page","blur","loader","color"]),y("div",z,[y("div",G,[W,y("div",Y,[y("div",Z,[j(y("input",{type:"text",class:"text-gray-400 text-center placeholder-gray-300 input-focus rounded-3xl px-16 py-2",placeholder:"請輸入關鍵字","onUpdate:modelValue":t[2]||(t[2]=e=>s.currKeyword=e)},null,512),[[S,s.currKeyword]]),y("span",{class:["text-xl cursor-pointer absolute right-3 pt-1.5",{"text-gray-400":s.currKeyword,"text-gray-300":!s.currKeyword}],onClick:t[3]||(t[3]=e=>s.clearInput())},[ee],2)]),y("span",{class:"text-yellow-400 ml-6 pt-1.5 md:text-xl active:scale-125",onClick:t[4]||(t[4]=e=>s.setKeyword("★"))},[te])]),y("p",{class:"text-md text-gray-400 cursor-pointer pt-2 text-right md:text-lg md:text-center dark:text-white",onClick:t[5]||(t[5]=e=>s.timeSort())},[ae,y("span",se,[y("i",{class:["fas fa-arrow-up duration-200",{"rotate-180":s.isRotate}]},null,2)])])]),re,(u(!0),m(f,null,v(e.filteredNote,(e=>(u(),m(i,{key:e._id,myNote:e},null,8,["myNote"])))),128)),e.myNotes.length?T("",!0):(u(),m("div",le,[oe,y(n,{class:"homeBtn",to:"/"},{default:g((()=>[ie])),_:1})]))])])};export{X as default};
