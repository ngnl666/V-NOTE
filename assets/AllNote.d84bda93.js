var e=Object.defineProperty,t=Object.defineProperties,a=Object.getOwnPropertyDescriptors,s=Object.getOwnPropertySymbols,r=Object.prototype.hasOwnProperty,o=Object.prototype.propertyIsEnumerable,l=(t,a,s)=>a in t?e(t,a,{enumerable:!0,configurable:!0,writable:!0,value:s}):t[a]=s,i=(e,t)=>{for(var a in t||(t={}))r.call(t,a)&&l(e,a,t[a]);if(s)for(var a of s(t))o.call(t,a)&&l(e,a,t[a]);return e};import{B as n,E as c,C as d,t as p,v as m,x as u,y,R as x,X as g,P as f,Q as v,L as h,D as b,A as w,n as k,F as N,J as j,V as T,I as M}from"./vendor.3fb11097.js";import{S}from"./sweetalert2.b9aa7158.js";import{f as C}from"./format.f6978c89.js";import{_ as O,a as _}from"./NoteTopBar.b51c26ee.js";const B={name:"MyNotes",props:{myNote:{type:Object}},components:{Modal:O,NoteTopBar:_},setup(e){const t=n("store"),{state:a,addStar:s,setShowModal:r,setAlertMsg:o,getTime:l,setKeyword:p,editNote:m,publishNote:u}=t,{markup:y}=C;let x=c(!0);const g=d(e).myNote,f=c(`${g.value.content.substring(0,200)}．．．`),v=new Promise((e=>{setTimeout((()=>{e({"0.jpg":"<img class='scenery' src='https://firebasestorage.googleapis.com/v0/b/v-note-86a34.appspot.com/o/scenes%2F0.jpg?alt=media&token=5656169a-a745-47c0-8646-a01acc7fa868'/>","1.jpg":"<img class='scenery' src='https://firebasestorage.googleapis.com/v0/b/v-note-86a34.appspot.com/o/scenes%2F1.jpg?alt=media&token=308023d2-0c14-4372-a44a-aec11975f616'/>","2.jpg":"<img class='scenery' src='https://firebasestorage.googleapis.com/v0/b/v-note-86a34.appspot.com/o/scenes%2F2.jpg?alt=media&token=540e741f-fac2-48af-ae06-3671b8be2565'/>"})}),1e3)}));return setTimeout((()=>x.value=!1),1e3),{addStar:s,getTime:l,loadNote:x,myNote:g,setShowModal:r,tempContent:f,highLight:e=>{if(a.keyword){let t=e.replace(new RegExp(a.keyword,"g"),`<span class="text-red-400">${a.keyword}</span>`);return y(t)}return y(e)},markup:y,openShareBox:async e=>{const{value:t}=await S.fire({title:`確定發布 <span class="text-red-400">${e}</span> 至探索`,html:"<p>平台上的所有人將會看到你發佈的文章，請先選擇背景圖</p>",width:"800px",input:"radio",confirmButtonText:"發佈",inputOptions:v,inputValidator:e=>{if(!e)return"請選擇一張背景圖!"}});if(g.value.shared&&o("error","你已經分享過此文章了！"),t&&!g.value.shared){const e={_id:g.value._id,scene:t,like:0},a=i({},g.value);a.shared=!0,await m(a._id,a),u(e),S.fire({html:"<p>發布成功！</p>",icon:"success"})}},searchTag:e=>p(`#${e}`)}}},K={class:"p-2 md:p-4"},L={key:0},P={class:"flex justify-between px-2 mb-6 md:px-6"},H=y("i",{class:"fas fa-share-alt"},null,-1),I=y("i",{class:"far fa-trash-alt"},null,-1),A={class:"text-yellow-400 md:text-xl"},$={class:"px-2 mb-8 md:px-6"},F=y("span",{class:"text-indigo-500 inline-flex items-center mt-4 md:text-xl"},[w("閱讀更多 "),y("i",{class:"fas fa-arrow-right ml-2"})],-1),R={class:"my-4 md:flex justify-between"},E={class:"flex flex-wrap"},V={class:"md:text-xl dark:text-white"},D=y("hr",null,null,-1),J={key:1,class:"shadow rounded-md p-4"},Q=g('<div class="flex animate-pulse space-x-4"><div class="h-12 w-12 bg-gray-400 rounded-full"></div><div class="flex-1 space-y-4 py-1"><div class="h-4 w-3/4 bg-gray-400 rounded"></div><div class="space-y-2"><div class="h-4 bg-gray-400 rounded"></div><div class="h-4 w-5/6 bg-gray-400 rounded"></div></div></div></div>',1);B.render=function(e,t,a,s,r,o){const l=p("NoteTopBar"),i=p("router-link");return m(),u("div",K,[s.loadNote?(m(),u("div",J,[Q])):(m(),u("div",L,[y("div",P,[y("h3",{class:"text-gray-900 text-2xl font-medium md:text-3xl dark:text-white",innerHTML:s.highLight(s.myNote.title)},null,8,["innerHTML"]),y(l,null,{edit:x((()=>[y("span",{class:"noteTopBarIcon mr-1 md:text-xl",onClick:t[1]||(t[1]=e=>s.openShareBox(s.myNote.title))},[H])])),delete:x((()=>[y("span",{class:"noteTopBarIcon md:text-xl",onClick:t[2]||(t[2]=e=>s.setShowModal(s.myNote,!0))},[I])])),star:x((()=>[y("span",A,[s.myNote.stared?(m(),u("i",{key:1,class:"fas fa-star iconHover",onClick:t[4]||(t[4]=e=>s.addStar(s.myNote._id,!1))})):(m(),u("i",{key:0,class:"far fa-star iconHover",onClick:t[3]||(t[3]=e=>s.addStar(s.myNote._id,!0))}))])])),_:1})]),y(i,{to:`/current/view/${s.myNote._id}`,class:"cursor-pointer"},{default:x((()=>[y("div",$,[y("section",{class:"break-words text-gray-500 md:text-xl dark:text-gray-400",innerHTML:s.highLight(s.tempContent)},null,8,["innerHTML"]),F]),y("div",R,[y("ul",E,[(m(!0),u(f,null,v(s.myNote.tags,((e,t)=>(m(),u("li",{class:"bg-gray-200 text-white rounded-md px-2 py-0.5 mr-4 mb-4 hover:bg-black md:mb-0 md:text-xl dark:bg-gray-400 dark:hover:bg-black",key:t,onClick:h((t=>s.searchTag(e)),["prevent"])}," # "+b(e),9,["onClick"])))),128))]),y("div",V,b(s.getTime(s.myNote.createdAt)),1)]),D])),_:1},8,["to"])]))])};const U={name:"AllNote",components:{MyNotes:B},setup(){const e=n("store"),{state:s,getAllNote:r,setKeyword:o,sortMyNotes:l}=e,p=c(!0),m=k({get:()=>s.keyword,set:e=>o(e.replace(/[^\w\s]/gi,""))});return N((async()=>{await r()})),u=i({},d(s)),t(u,a({clearInput:()=>o(""),currKeyword:m,isRotate:p,setKeyword:o,timeSort:()=>{p.value=!p.value,l(p.value)}}));var u}},X={class:"max-w-4xl mx-auto px-2 md:px-6"},q={class:"border border-gray-300 rounded-3xl p-8"},z={class:"mb-4 justify-between md:flex md:mb-8"},G=y("h2",{class:"pageTitle"},"文章列表",-1),W={class:"flex justify-center"},Y={class:"relative mb-4 md:mb-0"},Z=y("i",{class:"far fa-times-circle duration-150 hover:rotate-90"},null,-1),ee=y("i",{class:"fas fa-star"},null,-1),te=w(" 照時間順序"),ae={class:"ml-2"},se=y("hr",null,null,-1),re={key:0,class:"text-center"},oe=y("p",{class:"reminder"},"目前還沒有發表任何文章喔!",-1),le=w("回首頁");U.render=function(e,t,a,s,r,o){const l=p("MyNotes"),i=p("router-link");return m(),u("div",X,[y("div",q,[y("div",z,[G,y("div",W,[y("div",Y,[j(y("input",{type:"text",class:"text-gray-400 text-center placeholder-gray-300 input-focus rounded-3xl px-16 py-2",placeholder:"請輸入關鍵字","onUpdate:modelValue":t[1]||(t[1]=e=>s.currKeyword=e)},null,512),[[T,s.currKeyword]]),y("span",{class:["text-xl cursor-pointer absolute right-3 pt-1.5",{"text-gray-400":s.currKeyword,"text-gray-300":!s.currKeyword}],onClick:t[2]||(t[2]=e=>s.clearInput())},[Z],2)]),y("span",{class:"text-yellow-400 ml-6 pt-1.5 md:text-xl active:scale-125",onClick:t[3]||(t[3]=e=>s.setKeyword("★"))},[ee])]),y("p",{class:"text-md text-gray-400 cursor-pointer pt-2 text-right md:text-lg md:text-center dark:text-white",onClick:t[4]||(t[4]=e=>s.timeSort())},[te,y("span",ae,[y("i",{class:["fas fa-arrow-up duration-200",{"rotate-180":s.isRotate}]},null,2)])])]),se,(m(!0),u(f,null,v(e.filteredNote,(e=>(m(),u(l,{key:e._id,myNote:e},null,8,["myNote"])))),128)),e.myNotes.length?M("",!0):(m(),u("div",re,[oe,y(i,{class:"homeBtn",to:"/"},{default:x((()=>[le])),_:1})]))])])};export{U as default};
