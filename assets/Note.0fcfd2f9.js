var e=Object.defineProperty,t=Object.defineProperties,a=Object.getOwnPropertyDescriptors,l=Object.getOwnPropertySymbols,s=Object.prototype.hasOwnProperty,o=Object.prototype.propertyIsEnumerable,r=(t,a,l)=>a in t?e(t,a,{enumerable:!0,configurable:!0,writable:!0,value:l}):t[a]=l,n=(e,t)=>{for(var a in t||(t={}))s.call(t,a)&&r(e,a,t[a]);if(l)for(var a of l(t))o.call(t,a)&&r(e,a,t[a]);return e};import{B as i,C as d,v as c,x as u,y as m,R as p,T as f,S as g,G as b,E as x,m as y,F as v,U as h,J as k,V as w,W as I,I as N,P as C,Q as j,A as O,D as _}from"./vendor.3fb11097.js";import{f as S}from"./format.f6978c89.js";import{S as T}from"./sweetalert2.b9aa7158.js";const U={name:"CreateNote",setup(){const e=i("store"),{state:t}=e;return n({},d(t))}},E={class:"max-w-4xl mx-auto px-2 md:px-4"};U.render=function(e,t,a,l,s,o){return c(),u("div",E,[m(f,{name:"fade",mode:"out-in"},{default:p((()=>[e.isOpen?g(e.$slots,"note",{key:1}):g(e.$slots,"btn",{key:0})])),_:3})])};const A={name:"Note",setup(){var e;const l=i("store"),s=b(),{state:o,editNote:r,removeImg:c,removeCurrImage:u,setAlertMsg:m,setCurrImage:p,setIsEdit:f,setIsOpen:g,uploadImg:k,uploadNote:w}=l,{selectedArea:I,formatWord:N}=S,C=x(null);let j=x(!1),O=x("");const _=y({_id:o.currNote._id||"",uid:(null==(e=JSON.parse(localStorage.getItem("userInfo")))?void 0:e.uid)||"",author:o.currNote.author||o.userInfo.displayName,title:o.currNote.title||"",content:o.currNote.content||"",tags:o.currNote.tags||[],stared:o.currNote.stared||!1,image:o.currNote.image||"",shared:o.currNote.shared||!1,createdAt:o.currNote.createdAt||"",updatedAt:o.currNote.updatedAt||""});o.currNote.tags&&(_.tags=[...o.currNote.tags]);const U=T.mixin({customClass:{confirmButton:"bg-gray-300 text-white rounded-xl px-4 py-3 hover:bg-gray-300/50",htmlContainer:"!text-gray-400"},buttonsStyling:!1}),E=()=>{U.fire({title:"MarkDown 注意事項",icon:"info",html:'<ul class="space-y-2"><li>1. 將要 markdown 的文字<span class="font-bold">反白</span>後選取工具列</li><li>2. 若要取消 markdown 請<span class="font-bold">一同刪除兩側</span>的註記</li></ul>',confirmButtonText:"我知道了"})};return v((()=>{if(!o.userInfo)return m("error","請先登入！"),void s.push({name:"login"});o.userInfo.emailVerified||m("error","信箱驗證完成才可發文！"),E(),o.currNote.image&&p(o.currNote.image)})),h((()=>{f(!1),u()})),A=n({},d(o)),t(A,a({addTags:()=>{O.value&&_.tags.length<5&&_.tags.push(O.value),O.value=""},file:C,isNull:j,markup:e=>{const t=document.querySelector("textarea");if(t.selectionStart!==t.selectionEnd){const a=I(_.content,t.selectionStart,t.selectionEnd);_.content=N(_.content,a,e)}},note:_,openInfoBox:E,removeImg:c,setIsEdit:f,setIsOpen:g,tag:O,upload:e=>{if(!e.title||!e.content)return j.value=!0,void window.scrollTo({top:document.querySelector(".note").offsetTop-20,behavior:"smooth"});o.userInfo.emailVerified?(o.isEdit?r(e._id,e):w(e),g(!1),f(!1),j.value=!1,e.title=e.content=""):m("error","信箱驗證完成才可發文！")},uploadFile:async()=>{await k(C.value.files[0]),window.scrollTo(0,document.body.scrollHeight)}}));var A}},B={class:"note border border-gray-300 rounded-3xl p-6 mb-6 md:p-8"},P={class:"mb-8"},V={class:"flex justify-between mb-6"},q=m("label",{class:"text-gray-400 align-middle mr-4 dark:text-white",for:"note__title--input"},"標題:",-1),D=m("i",{class:"fas fa-info-circle hover:scale-110 duration-150"},null,-1),F={class:"mb-4"},H=m("label",{class:"text-gray-400 align-middle block mr-4 md:inline-block dark:text-white",for:"note__tags--input"},"Tags:",-1),J={class:"relative"},M=m("i",{class:"fas fa-arrow-alt-circle-right"},null,-1),W={key:0,class:"text-red-400 block mt-4 md:ml-4"},$={class:"flex flex-wrap"},G={class:"mb-8 md:w-10/12"},K={class:"mb-4 flex justify-between items-start"},Q={class:"text-gray-400 dark:text-white"},R=O("內文: "),z={class:"bg-gray-400/30 rounded-lg flex space-x-4 pr-4 py-1"},L=m("i",{class:"fas fa-text-height"},null,-1),X=m("i",{class:"fas fa-bold"},null,-1),Y=m("i",{class:"fas fa-underline"},null,-1),Z=m("i",{class:"fas fa-quote-right"},null,-1),ee={class:"noteUtility"},te=m("label",{for:"image"},[m("i",{class:"fas fa-images"})],-1),ae={class:"flex justify-center mt-8 flex-wrap"},le={class:"flex justify-end"};A.render=function(e,t,a,l,s,o){return c(),u("div",B,[m("div",P,[m("div",V,[m("div",null,[q,k(m("input",{type:"text",id:"note__title--input",class:"mt-2 inline-block",maxlength:"15",autocomplete:"off","onUpdate:modelValue":t[1]||(t[1]=e=>l.note.title=e)},null,512),[[w,l.note.title,void 0,{trim:!0}]]),m("span",{class:["text-red-400 block mt-4 md:ml-4",{hidden:!l.isNull}]},"*此欄位不能為空",2)]),m("div",{class:"text-3xl text-red-400 cursor-pointer animate-pulse md:pr-6",onClick:t[2]||(t[2]=(...e)=>l.openInfoBox&&l.openInfoBox(...e))},[D])]),m("div",F,[H,m("span",J,[k(m("input",{type:"text",id:"note__tags--input",class:"mt-2",maxlength:"10",autocomplete:"off","onUpdate:modelValue":t[3]||(t[3]=e=>l.tag=e),onKeyup:t[4]||(t[4]=I((e=>l.addTags()),["enter"]))},null,544),[[w,l.tag,void 0,{trim:!0}]]),m("span",{class:"text-2xl text-green-400 absolute right-3 pt-1 mt-2",onClick:t[5]||(t[5]=e=>l.addTags())},[M]),5===l.note.tags.length?(c(),u("div",W," *最多同時擁有 5 個 tag ")):N("",!0)])]),m("ul",$,[(c(!0),u(C,null,j(l.note.tags,((e,t)=>(c(),u("li",{class:"bg-gray-200 text-white rounded-md px-2 py-0.5 mr-4 mb-4 md:mb-0 dark:bg-gray-400",key:t}," # "+_(e),1)))),128))])]),m("div",G,[m("div",K,[m("label",Q,[R,m("span",{class:["text-red-400 block mt-4 md:ml-4",{hidden:!l.isNull}]},"*此欄位不能為空",2)]),m("div",z,[m("span",{class:"noteUtility pl-4",onClick:t[6]||(t[6]=e=>l.markup("font"))},[L]),m("span",{class:"noteUtility",onClick:t[7]||(t[7]=e=>l.markup("bold"))},[X]),m("span",{class:"noteUtility",onClick:t[8]||(t[8]=e=>l.markup("underline"))},[Y]),m("span",{class:"noteUtility",onClick:t[9]||(t[9]=e=>l.markup("quote"))},[Z]),m("span",ee,[te,m("input",{type:"file",class:"hidden",name:"image",id:"image",accept:".png,.jpg,.jpeg",ref:"file",onChange:t[10]||(t[10]=e=>l.uploadFile())},null,544)])])]),k(m("textarea",{"onUpdate:modelValue":t[11]||(t[11]=e=>l.note.content=e)},null,512),[[w,l.note.content,void 0,{trim:!0}]]),m("div",ae,[(c(!0),u(C,null,j(e.currImage,(e=>(c(),u("div",{class:"m-4 relative",key:e._id},[m("i",{class:"fas fa-times-circle text-xl absolute -top-4 -left-2 iconHover",onClick:t=>l.removeImg(e)},null,8,["onClick"]),m("img",{class:"w-52 h-32 rounded-md shadow-2xl",src:e.url,alt:"my-image"},null,8,["src"])])))),128))])]),m("div",le,[m("button",{class:"bg-transparent border border-red-700 text-red-700 font-bold rounded py-2 px-6 mr-4 hover:bg-red-700 hover:text-white dark:text-white",onClick:t[12]||(t[12]=e=>{l.setIsOpen(!1),l.setIsEdit(!1)})}," 取消 "),m("button",{class:"bg-green-400 text-white font-bold rounded py-2 px-6 hover:bg-green-500",onClick:t[13]||(t[13]=e=>l.upload(l.note))}," 上傳 ")])])};export{U as _,A as a};
